{
    "contents" : "library(shiny)\nsource(\"Reliability.R\")\n\nshinyServer(function(input, output) {\n   \n    impX <- function(){as.numeric(input$x)}\n    impP <- function(){as.numeric(input$p)}\n    impR <- function(){as.numeric(input$r)}\n    impI <- function(){as.numeric(input$pil)}\n    \n    impmusaP <- function(){as.numeric(input$musaP)}\n    impduaneP <- function(){as.numeric(input$duaneP)}\n    implvP <- function(){as.numeric(input$lvP)}\n    impokumotoP <- function(){as.numeric(input$okumotoP)}\n    impgeoP <- function(){as.numeric(input$geoP)}\n    impjmP <- function(){as.numeric(input$jmP)}\n    \n    impT <- function(){   \n      inFile <- input$file\n      if (is.null(inFile))\n        return(NULL)\n      data <- read.csv(inFile$datapath, header=FALSE, sep=\",\")\n      data <- as.numeric(data)\n      return(data)\n    }\n  \n    output$total_plot <- renderPlot({\n      \n      inFile <- input$file\n      if (is.null(inFile))\n        return(NULL)\n      t <- impT()\n      musa.basic.par3 <- impX()\n      jelinski.moranda.par3 <- impP()\n      jelinski.moranda.par4 <- impR()\n      \n      duane.par1 <- duane(t)$rho\n      duane.par2 <- duane(t)$theta\n      \n      lit.par1 <- littlewood.verall(t, linear = T)$theta0\n      lit.par2 <- littlewood.verall(t, linear = T)$theta1\n      lit.par3 <- littlewood.verall(t, linear = T)$rho\n      \n      mor.par1 <- moranda.geometric(t)$D\n      mor.par2 <- moranda.geometric(t)$theta\n      \n      musa.par1 <- musa.okumoto(t)$theta0\n      musa.par2 <- musa.okumoto(t)$theta1\n      \n      musa.basic.par1 <- musa.basic(t,musa.basic.par3)$beta0\n      musa.basic.par2 <- musa.basic(t,musa.basic.par3)$beta1\n      \n      jelinski.moranda.par1 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$N0\n      jelinski.moranda.par2 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$phi\n      \n      total.plot(jelinski.moranda.par1, jelinski.moranda.par2, jelinski.moranda.par3, jelinski.moranda.par4,\n                 musa.basic.par1, musa.basic.par2,duane.par1, duane.par2, lit.par1, lit.par2, lit.par3, mor.par1,\n                 mor.par2, musa.par1, musa.par2, t, linear = T, xlab = \"Time (in hours)\", main = \"All models\")\n    })\n    \n    output$rel_plot <- renderPlot({\n       \n       inFile <- input$file\n       if (is.null(inFile))\n          return(NULL)\n       t <- impT()\n       musa.basic.par3 <- impX()\n       jelinski.moranda.par3 <- impP()\n       jelinski.moranda.par4 <- impR()\n       \n       duane.par1 <- duane(t)$rho\n       duane.par2 <- duane(t)$theta\n       \n       lit.par1 <- littlewood.verall(t, linear = T)$theta0\n       lit.par2 <- littlewood.verall(t, linear = T)$theta1\n       lit.par3 <- littlewood.verall(t, linear = T)$rho\n       \n       mor.par1 <- moranda.geometric(t)$D\n       mor.par2 <- moranda.geometric(t)$theta\n       \n       musa.par1 <- musa.okumoto(t)$theta0\n       musa.par2 <- musa.okumoto(t)$theta1\n       \n       musa.basic.par1 <- musa.basic(t,musa.basic.par3)$beta0\n       musa.basic.par2 <- musa.basic(t,musa.basic.par3)$beta1\n       \n       jelinski.moranda.par1 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$N0\n       jelinski.moranda.par2 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$phi\n       \n       rel.plot(jelinski.moranda.par1, jelinski.moranda.par2, jelinski.moranda.par3, \n                jelinski.moranda.par4,\n                musa.basic.par1, musa.basic.par2,\n                duane.par1, duane.par2,\n                lit.par1, lit.par2, lit.par3,\n                mor.par1, mor.par2,\n                musa.par1, musa.par2,\n                t, linear = T, ymin = -1,\n                ymax = 2.5, xlab = \"Time (in hours)\", main = \"Relative error\")\n    })\n    \n    output$rank <- renderDataTable({\n       inFile <- input$file\n       if (is.null(inFile))\n          return(NULL)\n       t <- impT()\n       musa.basic.par3 <- impX()\n       jelinski.moranda.par3 <- impP()\n       jelinski.moranda.par4 <- impR()\n       \n       duane.par1 <- duane(t)$rho\n       duane.par2 <- duane(t)$theta\n       \n       lit.par1 <- littlewood.verall(t, linear = T)$theta0\n       lit.par2 <- littlewood.verall(t, linear = T)$theta1\n       lit.par3 <- littlewood.verall(t, linear = T)$rho\n       \n       mor.par1 <- moranda.geometric(t)$D\n       mor.par2 <- moranda.geometric(t)$theta\n       \n       musa.par1 <- musa.okumoto(t)$theta0\n       musa.par2 <- musa.okumoto(t)$theta1\n       \n       musa.basic.par1 <- musa.basic(t,musa.basic.par3)$beta0\n       musa.basic.par2 <- musa.basic(t,musa.basic.par3)$beta1\n       \n       jelinski.moranda.par1 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$N0\n       jelinski.moranda.par2 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$phi\n       \n       return(rank.rel(jelinski.moranda.par1, jelinski.moranda.par2, jelinski.moranda.par3, \n                          jelinski.moranda.par4,\n                          musa.basic.par1, musa.basic.par2, duane.par1, duane.par2, lit.par1, \n                          lit.par2, lit.par3, mor.par1,\n                          mor.par2, musa.par1, musa.par2, t, linear = T))\n    }, options = list(pageLength = 10))\n    \n    output$pred_plot <- renderPlot({\n       \n       inFile <- input$file\n       if (is.null(inFile))\n          return(NULL)\n       t <- impT()\n       musa.basic.par3 <- impX()\n       jelinski.moranda.par3 <- impP()\n       jelinski.moranda.par4 <- impR()\n       \n       duane.par1 <- duane(t)$rho\n       duane.par2 <- duane(t)$theta\n       \n       lit.par1 <- littlewood.verall(t, linear = T)$theta0\n       lit.par2 <- littlewood.verall(t, linear = T)$theta1\n       lit.par3 <- littlewood.verall(t, linear = T)$rho\n       \n       mor.par1 <- moranda.geometric(t)$D\n       mor.par2 <- moranda.geometric(t)$theta\n       \n       musa.par1 <- musa.okumoto(t)$theta0\n       musa.par2 <- musa.okumoto(t)$theta1\n       \n       musa.basic.par1 <- musa.basic(t,musa.basic.par3)$beta0\n       musa.basic.par2 <- musa.basic(t,musa.basic.par3)$beta1\n       \n       jelinski.moranda.par1 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$N0\n       jelinski.moranda.par2 <- jelisnki.moranda(t, jelinski.moranda.par3, jelinski.moranda.par4)$phi\n\n       t_aux <- cumsum(t)\n       tmax <- t_aux[length(t)]\n       interval <- impI()\n       new_t <- tmax + 0:interval\n       \n       musaP <- impmusaP()\n       duaneP <- impduaneP()\n       lvP <- implvP()\n       okumotoP <- impokumotoP()\n       geoP <- impgeoP()\n       jmP <- impjmP()\n       \n       prediction.plot(musaP, duaneP, lvP, okumotoP, geoP, jmP,\n                       jelinski.moranda.par1, jelinski.moranda.par2, jelinski.moranda.par3, jelinski.moranda.par4,\n                       musa.basic.par1, musa.basic.par2,duane.par1, duane.par2, lit.par1, lit.par2, lit.par3, mor.par1,\n                       mor.par2, musa.par1, musa.par2, rep(1,interval), linear = T, xlab = \"Time (in hours)\", main = \"All models\")\n    })\n    \n  }\n)\n",
    "created" : 1442004789593.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1798290036",
    "id" : "F2D1AEEF",
    "lastKnownWriteTime" : 1416899176,
    "path" : "J:/Proyecto-shiny-Eafit/Shiny-Eafit/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}